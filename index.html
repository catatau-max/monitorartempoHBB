<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Monitor Habbo</title>

<style>
    /* Fundo branco */
    body {
        font-family: Arial, sans-serif;
        background: white;
        color: #333;
        text-align: center;
        margin: 0;
        padding: 30px;
        position: relative;
        min-height: 100vh;
    }
    
    /* Imagem centralizada e transparente */
    body::before {
        content: "";
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 400px;
        height: 400px;
        background-image: url('https://pbs.twimg.com/profile_images/1409594416449347588/r6otSTVT_400x400.jpg');
        background-size: contain;
        background-position: center;
        background-repeat: no-repeat;
        opacity: 0.15;
        pointer-events: none;
        z-index: 0;
    }
    
    h1, div, .card, #resultado, #progress, #botoesPaginacao, .pesquisa-info {
        position: relative;
        z-index: 1;
    }

h1 { 
    margin-bottom: 20px;
    color: #22c55e;
}

input, select {
    padding: 10px;
    border-radius: 8px;
    border: 1px solid #ddd;
    outline: none;
    margin: 5px;
    background: white;
    color: #333;
}

button {
    padding: 10px 15px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    background: #22c55e;
    color: white;
    font-weight: bold;
    transition: all 0.3s;
}

button:hover:not(:disabled) {
    background: #16a34a;
    transform: scale(1.05);
}

button:disabled {
    background: #aaa;
    cursor: not-allowed;
    opacity: 0.5;
}

/* Nova √°rea para colar lista */
.area-cola {
    background: #f8fafc;
    border: 2px dashed #22c55e;
    border-radius: 8px;
    padding: 20px;
    margin: 20px auto;
    max-width: 800px;
}

textarea {
    width: 100%;
    min-height: 150px;
    padding: 15px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-family: monospace;
    font-size: 14px;
    resize: vertical;
    box-sizing: border-box;
    margin-bottom: 15px;
}

textarea:focus {
    outline: none;
    border-color: #22c55e;
    box-shadow: 0 0 0 3px rgba(34,197,94,0.1);
}

.exemplo {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 6px;
    padding: 10px;
    margin: 10px 0;
    font-size: 12px;
    color: #64748b;
    text-align: left;
}

.exemplo code {
    color: #22c55e;
    background: #f1f5f9;
    padding: 2px 6px;
    border-radius: 4px;
}

#resultado {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 15px;
    max-width: 1400px;
    margin: 20px auto;
    padding: 0 20px;
}

@media (max-width: 1200px) {
    #resultado { grid-template-columns: repeat(4, 1fr); }
}

@media (max-width: 900px) {
    #resultado { grid-template-columns: repeat(3, 1fr); }
}

@media (max-width: 600px) {
    #resultado { grid-template-columns: repeat(2, 1fr); }
}

@media (max-width: 400px) {
    #resultado { grid-template-columns: 1fr; }
}

.card {
    background: rgba(30, 41, 59, 0.9);
    padding: 15px;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: 10px;
    transition: all 0.3s;
    border: 1px solid #334155;
    color: white;
}

.card:hover {
    transform: translateY(-5px);
    background: rgba(45, 58, 79, 0.95);
    border-color: #22c55e;
    box-shadow: 0 10px 20px rgba(0,0,0,0.3);
}

.card img {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    border: 3px solid #22c55e;
    object-fit: cover;
}

.online { color: #22c55e; font-weight: bold; }
.offline { color: #ef4444; font-weight: bold; }

.tempo { 
    font-size: 11px; 
    opacity: 0.7;
    background: #0f172a;
    padding: 3px 8px;
    border-radius: 12px;
    margin-top: 5px;
}

.card a {
    color: #22c55e;
    text-decoration: none;
    font-size: 12px;
    margin-top: 5px;
    display: inline-block;
}

.card a:hover {
    text-decoration: underline;
}

.loader {
    border: 5px solid #f3f3f3;
    border-top: 5px solid #22c55e;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
    margin: 20px auto;
}

.loader-pequeno {
    border: 3px solid #f3f3f3;
    border-top: 3px solid #22c55e;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    animation: spin 1s linear infinite;
    display: inline-block;
    margin-left: 10px;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

#progress { 
    margin-top: 10px; 
    font-size: 14px; 
    opacity: 0.8;
    min-height: 20px;
    color: #666;
}

#botoesPaginacao { 
    margin-top: 30px; 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    gap: 20px;
}

#indicadorPagina {
    background: #f0f0f0;
    padding: 8px 20px;
    border-radius: 20px;
    font-size: 14px;
    border: 1px solid #ddd;
    color: #333;
}

#totalUsuarios {
    font-size: 12px;
    opacity: 0.7;
    margin-top: 5px;
    color: #666;
}

.pesquisa-info {
    background: #f0f0f0;
    padding: 10px;
    border-radius: 8px;
    margin: 10px auto;
    max-width: 600px;
    font-size: 14px;
    border: 1px solid #22c55e;
    color: #333;
}

.pesquisa-item {
    background: white;
    padding: 5px 10px;
    border-radius: 20px;
    display: inline-block;
    margin: 3px;
    font-size: 12px;
    border: 1px solid #22c55e;
}
</style>
</head>

<body>

<h1>üîé Monitor Habbo</h1>

<!-- NOVA √ÅREA PARA COLAR LISTA -->
<div class="area-cola">
    <h3>üìã Cole sua lista de nicks (um por linha)</h3>
    <textarea id="inputNicks" placeholder="Cole sua lista aqui...
Exemplo:
A-Twink 47 minutos
crossfire387 20 minutos
-NikkoGod- 1 hora
@Nilmar 2 horas
Bo@ventura 5 minutos"></textarea>
    
    <div class="exemplo">
        <strong>üí° Dica:</strong> O sistema ignora tudo ap√≥s o primeiro espa√ßo!<br>
        <code>Sir,Pessoto 7 minutos</code> ‚Üí <strong>Sir,Pessoto</strong> (preserva v√≠rgula)
    </div>
    
    <div>
        <button onclick="processarLista()">üìã Processar Lista</button>
        <button class="secundario" onclick="copiarExemploRapido()">üìã Copiar Exemplo</button>
        <button class="perigo" onclick="limparLista()">üóëÔ∏è Limpar Lista</button>
    </div>
</div>

<!-- √ÅREA DE PESQUISA MANUAL (MANTIDA) -->
<div>
    <input type="text" id="pesquisa" placeholder="Digite um nome">
    <button onclick="adicionarPesquisa()">‚ûï Adicionar</button>
    <button onclick="limparPesquisas()">üóëÔ∏è Limpar Pesquisas</button>
    <button onclick="voltarListaCompleta()">üìã Lista Completa</button>
</div>

<select id="filtro" onchange="aplicarFiltro()">
    <option value="todos">Todos</option>
    <option value="online">Online</option>
    <option value="offline">Offline</option>
</select>

<div id="pesquisaInfo" class="pesquisa-info" style="display:none;"></div>

<div id="resultado"></div>
<div id="progress"></div>
<div id="totalUsuarios"></div>

<div id="botoesPaginacao">
    <button id="btnAnterior" onclick="carregarAnterior()">‚Üê Anterior</button>
    <span id="indicadorPagina">P√°gina 1</span>
    <button id="btnProximo" onclick="carregarProximo()">Pr√≥ximo ‚Üí</button>
</div>

<script>
// Lista completa de usu√°rios (definida mas N√ÉO carregada automaticamente)
const usuariosCompleto = [
    "Valdiir25", "Coelinha_Mal", "-Nathan-", "jessicaluana100", "Le.Mestre1",
    "@Fidick", "OpenTche", "@_pudim_", "@BrunnoLBM", "Mystico!",
    "Fuh", "Kai_Ryu", "unloav", "vic10r", "Eu_Bekka",
    "zRAROz7", "-Samuca,", "Northpack", "Strellinha", "Bechr",
    "h.sroque_", "Wyra", "PedroH8584FK", "!p:Ana:q!", "xxHeider",
    "tripis", "SaradaUchila1", "Nascimentos", "JRBob10", "CissaMalandrinh",
    "fiscina1003", "crossfire387", "boleto_", "kaique0834", "Isaaaaah0202",
    "eudesbingoo", "mellzinhaK", "HigorzinFLIP", "rockmillew41", "MFF_Adrielzin",
    "Juliaigor", "Sir:Reis", "edszika20", "?:.tami.:?", "softchaotic",
    "theusS2", "AriesDeNeon", "ox.Bella.xo", "J0N45_", "enakolady",
    "GabriellZKD", ".:Percy-Jackson", "felipe@324", "matheus60343", ",miilaa",
    "SonGoku.", "==Hewlsingy=", "Hoxen", "Deamo", "odeivio991",
    "ArthurZ3Party", "zzzs2sz", "Bione525", "kikit4", "A-Twink",
    "Yuri", "Veteranox", "raquellkelly", "MaxKd6", "iFoice",
    "-.-IGREJA-.-", "Juliabr@", "-Fonter30", ".Fighter.", "Aeshia",
    "joao7774", "Alegretupac2", "X-Sr.Bruninho", "-Powa-", "Bo@ventura",
    "gilmarOboladao", "_BelleBoyer", "Carolina2_8", "Rafael_Ds1", "luis123345",
    "Ioyd", "gothlucasx67", "jubileu028", "Mariana-432", "Lunnaticah",
    "Flokiih", "paoduro56", "BinhoSantosz", "Dogas97", "CauanDoLol",
    "EduardoZnX", "PerseuNoah", "mariapalha09", "dommarcos3", "Andressa_SS",
    "Fed0", "elison789", "Lewszz", "angelmiranda", "GabrielSantoss",
    "Kamilly211", "AndreZinhoChic", "Pedriinho_013", "FULano.Ab13"
];

// Lista atual come√ßa vazia
let usuarios = [];

// Lista de pesquisa acumulada
let pesquisaAcumulada = [];

// Cache e controle
let cacheStatus = {};
let statusUsuarios = {};
let paginaAtual = 0;
const porPagina = 20;
let carregando = false;

// Proxies
const proxies = [
    'https://api.allorigins.win/raw?url=',
    'https://corsproxy.io/?',
    'https://thingproxy.freeboard.io/fetch/'
];

// Fun√ß√£o delay
function delay(ms) { 
    return new Promise(resolve => setTimeout(resolve, ms)); 
}

// Fun√ß√£o para verificar status
async function verificarStatus(nome) {
    // Verifica cache
    if (cacheStatus[nome] && (Date.now() - cacheStatus[nome].timestamp) < 300000) {
        return cacheStatus[nome].online;
    }
    
    for (const proxy of proxies) {
        try {
            const url1 = `https://www.habbo.com.br/api/public/users?name=${encodeURIComponent(nome)}`;
            const response = await fetch(proxy + encodeURIComponent(url1));
            
            if (!response.ok) continue;
            
            const data = await response.json();
            
            if (!data || !data.uniqueId) continue;
            
            const url2 = `https://www.habbo.com.br/api/public/users/${data.uniqueId}`;
            const response2 = await fetch(proxy + encodeURIComponent(url2));
            
            if (!response2.ok) continue;
            
            const data2 = await response2.json();
            
            if (data2 && typeof data2.online !== 'undefined') {
                cacheStatus[nome] = {
                    online: data2.online === true,
                    timestamp: Date.now()
                };
                return data2.online === true;
            }
            
        } catch (e) {
            continue;
        }
    }
    
    return null;
}

// ‚ö° FUN√á√ÉO CORRIGIDA: Adicionar pesquisa com LOADER ‚ö°
function adicionarPesquisa() {
    const nome = document.getElementById("pesquisa").value.trim();
    if (!nome) {
        alert("Digite um nome");
        return;
    }
    
    if (pesquisaAcumulada.length >= 20) {
        alert("Limite de 20 pesquisas atingido!");
        return;
    }
    
    if (pesquisaAcumulada.includes(nome)) {
        alert("Este nome j√° foi adicionado!");
        return;
    }
    
    pesquisaAcumulada.push(nome);
    atualizarPesquisaInfo();
    
    usuarios = [...pesquisaAcumulada];
    paginaAtual = 0;
    
    // ‚ö° MOSTRA LOADER ANTES DE COME√áAR ‚ö°
    document.getElementById("resultado").innerHTML = `<div class="loader"></div>`;
    document.getElementById("progress").innerHTML = `üîç Carregando ${usuarios.length} usu√°rio(s)...`;
    
    if (usuarios.length <= 20) {
        document.getElementById("btnProximo").style.display = "none";
        document.getElementById("btnAnterior").style.display = "none";
        document.getElementById("indicadorPagina").style.display = "none";
    } else {
        document.getElementById("btnProximo").style.display = "inline-block";
        document.getElementById("btnAnterior").style.display = "inline-block";
        document.getElementById("indicadorPagina").style.display = "inline-block";
    }
    
    document.getElementById("pesquisa").value = "";
    
    // ‚ö° CHAMA A FUN√á√ÉO QUE VERIFICA OS USU√ÅRIOS ‚ö°
    verificarUsuarios();
}

// ‚ö° FUN√á√ÉO CORRIGIDA: Processar lista com LOADER ‚ö°
function processarLista() {
    const texto = document.getElementById('inputNicks').value;
    const linhas = texto.split('\n');
    
    const nicksProcessados = [];
    
    linhas.forEach(linha => {
        linha = linha.trim();
        if (linha === '') return;
        
        linha = linha.replace(/\t/g, ' ');
        linha = linha.replace(/\s+/g, ' ');
        
        const primeiroEspaco = linha.indexOf(' ');
        
        if (primeiroEspaco > 0) {
            let nick = linha.substring(0, primeiroEspaco).trim();
            if (nick && !nicksProcessados.includes(nick)) {
                nicksProcessados.push(nick);
            }
        } else {
            let nick = linha;
            if (nick && !nicksProcessados.includes(nick)) {
                nicksProcessados.push(nick);
            }
        }
    });
    
    if (nicksProcessados.length > 0) {
        usuarios = nicksProcessados;
        pesquisaAcumulada = [];
        paginaAtual = 0;
        cacheStatus = {};
        statusUsuarios = {};
        
        atualizarPesquisaInfo();
        
        // ‚ö° MOSTRA LOADER ANTES DE COME√áAR ‚ö°
        document.getElementById("resultado").innerHTML = `<div class="loader"></div>`;
        document.getElementById("progress").innerHTML = `üîç Processando ${usuarios.length} usu√°rios...`;
        document.getElementById('totalUsuarios').innerHTML = `üìä Total: ${usuarios.length} nicks carregados`;
        
        if (usuarios.length <= 20) {
            document.getElementById("btnProximo").style.display = "none";
            document.getElementById("btnAnterior").style.display = "none";
            document.getElementById("indicadorPagina").style.display = "none";
        } else {
            document.getElementById("btnProximo").style.display = "inline-block";
            document.getElementById("btnAnterior").style.display = "inline-block";
            document.getElementById("indicadorPagina").style.display = "inline-block";
        }
        
        // ‚ö° CHAMA A FUN√á√ÉO QUE VERIFICA OS USU√ÅRIOS ‚ö°
        verificarUsuarios();
    } else {
        alert('Nenhum nick v√°lido encontrado!');
    }
}

// ‚ö° FUN√á√ÉO CORRIGIDA: Lista completa com LOADER ‚ö°
function voltarListaCompleta() {
    pesquisaAcumulada = [];
    usuarios = [...usuariosCompleto];
    paginaAtual = 0;
    cacheStatus = {};
    statusUsuarios = {};
    atualizarPesquisaInfo();
    
    // ‚ö° MOSTRA LOADER ANTES DE COME√áAR ‚ö°
    document.getElementById("resultado").innerHTML = `<div class="loader"></div>`;
    document.getElementById("progress").innerHTML = `üîç Carregando lista completa (${usuarios.length} usu√°rios)...`;
    
    document.getElementById("btnProximo").style.display = "inline-block";
    document.getElementById("btnAnterior").style.display = "inline-block";
    document.getElementById("indicadorPagina").style.display = "inline-block";
    
    // ‚ö° CHAMA A FUN√á√ÉO QUE VERIFICA OS USU√ÅRIOS ‚ö°
    verificarUsuarios();
}

// ‚ö° NOVA FUN√á√ÉO: Verificar usu√°rios (separada da atualizarPagina) ‚ö°
async function verificarUsuarios() {
    if (carregando) return;
    if (usuarios.length === 0) return;
    
    carregando = true;
    
    const filtro = document.getElementById("filtro").value;
    const resultado = document.getElementById("resultado");
    const progress = document.getElementById("progress");

    const inicio = paginaAtual * porPagina;
    const fim = Math.min(inicio + porPagina, usuarios.length);
    
    const totalPaginas = Math.ceil(usuarios.length / porPagina);
    document.getElementById('totalUsuarios').innerHTML = `üìä Total: ${usuarios.length} usu√°rios | P√°gina ${paginaAtual + 1} de ${totalPaginas}`;
    
    let htmlFinal = "";
    let carregados = 0;
    let onlineCount = 0;
    let offlineCount = 0;
    let falhaCount = 0;
    
    for (let i = inicio; i < fim; i++) {
        const nome = usuarios[i];
        
        progress.innerHTML = `üì° Verificando ${nome}... (${i + 1 - inicio}/${fim - inicio}) <span class="loader-pequeno"></span>`;
        
        const online = await verificarStatus(nome);
        
        if (online === true) {
            onlineCount++;
            if (!statusUsuarios[nome]) statusUsuarios[nome] = Date.now();
        } else if (online === false) {
            offlineCount++;
            delete statusUsuarios[nome];
        } else {
            falhaCount++;
        }
        
        if (filtro === "online" && online !== true) continue;
        if (filtro === "offline" && online !== false) continue;
        
        let tempoOnline = "";
        if (statusUsuarios[nome]) {
            const minutos = Math.floor((Date.now() - statusUsuarios[nome]) / 60000);
            tempoOnline = `Online h√° ${minutos} min`;
        }
        
        htmlFinal += criarCard(nome, online, tempoOnline);
        carregados++;
        
        resultado.innerHTML = htmlFinal;
        
        await delay(500);
    }
    
    if (htmlFinal === "") {
        resultado.innerHTML = "<p style='color:#333; text-align:center; padding:20px;'>‚ùå Nenhum usu√°rio encontrado com os filtros atuais</p>";
    }
    
    progress.innerHTML = `‚úÖ Verificados: ${carregados} usu√°rios (üü¢ ${onlineCount} online | üî¥ ${offlineCount} offline | ‚ùì ${falhaCount} falhas)`;
    
    document.getElementById("btnAnterior").disabled = paginaAtual === 0;
    document.getElementById("btnProximo").disabled = fim >= usuarios.length;
    
    carregando = false;
}

// ‚ö° FUN√á√ÉO MODIFICADA: Atualizar p√°gina (agora chama verificarUsuarios) ‚ö°
async function atualizarPagina() {
    if (usuarios.length === 0) {
        document.getElementById("resultado").innerHTML = '<p style="color:#666; text-align:center; padding:40px;">üëã Nenhum usu√°rio carregado. Use as op√ß√µes acima para come√ßar.</p>';
        return;
    }
    
    // Se n√£o est√° carregando, come√ßa verifica√ß√£o
    if (!carregando) {
        await verificarUsuarios();
    }
}

// Atualizar pesquisa info
function atualizarPesquisaInfo() {
    const div = document.getElementById("pesquisaInfo");
    if (pesquisaAcumulada.length > 0) {
        div.style.display = "block";
        let html = "üîç Pesquisando: ";
        pesquisaAcumulada.forEach(nome => {
            html += `<span class="pesquisa-item">${nome}</span>`;
        });
        html += ` <small>(${pesquisaAcumulada.length}/20)</small>`;
        div.innerHTML = html;
    } else {
        div.style.display = "none";
    }
}

// Limpar pesquisas
function limparPesquisas() {
    pesquisaAcumulada = [];
    usuarios = [];
    cacheStatus = {};
    statusUsuarios = {};
    atualizarPesquisaInfo();
    document.getElementById("pesquisa").value = "";
    document.getElementById("resultado").innerHTML = '<p style="color:#666; text-align:center; padding:40px;">üëã Cole uma lista de nicks acima ou adicione manualmente.</p>';
    document.getElementById("progress").innerHTML = "";
    document.getElementById("totalUsuarios").innerHTML = "";
    
    document.getElementById("btnProximo").style.display = "inline-block";
    document.getElementById("btnAnterior").style.display = "inline-block";
    document.getElementById("indicadorPagina").style.display = "inline-block";
}

// Criar card HTML
function criarCard(nome, online, tempoOnline) {
    let statusText, statusClass;
    
    if (online === null) {
        statusText = '‚ùå N√£o encontrado';
        statusClass = 'offline';
    } else if (online === true) {
        statusText = 'üü¢ Online';
        statusClass = 'online';
    } else {
        statusText = 'üî¥ Offline';
        statusClass = 'offline';
    }
    
    return `
        <div class="card">
            <img src="https://www.habbo.com.br/habbo-imaging/avatarimage?user=${encodeURIComponent(nome)}&size=l" 
                 alt="${nome}"
                 onerror="this.src='https://www.habbo.com.br/habbo-imaging/avatarimage?user=Habbo&size=l'">
            <div>
                <strong>${nome.length > 15 ? nome.substring(0,15)+'...' : nome}</strong><br>
                <span class="${statusClass}">${statusText}</span><br>
                ${tempoOnline ? `<div class="tempo">${tempoOnline}</div>` : ""}
                <a href="https://www.habbo.com.br/profile/${encodeURIComponent(nome)}" target="_blank">Ver perfil</a>
            </div>
        </div>
    `;
}

// Navega√ß√£o
function carregarProximo() {
    if (carregando) return;
    const totalPaginas = Math.ceil(usuarios.length / porPagina);
    if (paginaAtual < totalPaginas - 1) {
        paginaAtual++;
        document.getElementById("resultado").innerHTML = `<div class="loader"></div>`;
        document.getElementById("progress").innerHTML = `üîç Carregando p√°gina ${paginaAtual + 1}...`;
        verificarUsuarios();
    }
}

function carregarAnterior() {
    if (carregando) return;
    if (paginaAtual > 0) {
        paginaAtual--;
        document.getElementById("resultado").innerHTML = `<div class="loader"></div>`;
        document.getElementById("progress").innerHTML = `üîç Carregando p√°gina ${paginaAtual + 1}...`;
        verificarUsuarios();
    }
}

function aplicarFiltro() {
    if (carregando) return;
    if (usuarios.length === 0) return;
    paginaAtual = 0;
    document.getElementById("resultado").innerHTML = `<div class="loader"></div>`;
    document.getElementById("progress").innerHTML = `üîç Aplicando filtro...`;
    verificarUsuarios();
}

// Inicializa√ß√£o
window.onload = function() {
    document.getElementById("resultado").innerHTML = '<p style="color:#666; text-align:center; padding:40px;">üëã Bem-vindo! Use as op√ß√µes acima para come√ßar:<br><br>üìã Cole uma lista e clique em "Processar Lista"<br>‚ûï Adicione nomes manualmente<br>üìã Clique em "Lista Completa" para ver todos</p>';
};
</script>

</body>
</html>
